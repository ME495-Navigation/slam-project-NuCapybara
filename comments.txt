many tests fail, but otherwise the code accomplishes the goals
